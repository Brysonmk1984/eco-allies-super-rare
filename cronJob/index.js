const Web3 = require("web3");

const contractJson = process.env.NODE_ENV === 'development' ? require("../build/contracts/AllyCore.json") : 

{"contractName":"AllyCore","abi":[{"constant":true,"inputs":[],"name":"owner","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function","signature":"0x8da5cb5b"},{"constant":false,"inputs":[],"name":"owned","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function","signature":"0xdf32754b"},{"constant":false,"inputs":[{"name":"_dna","type":"bytes32"}],"name":"addToAllyArray","outputs":[{"name":"","type":"bytes32[]"}],"payable":false,"stateMutability":"nonpayable","type":"function","signature":"0x06da7d84"},{"constant":true,"inputs":[],"name":"getAllAllies","outputs":[{"name":"","type":"bytes32[]"}],"payable":false,"stateMutability":"view","type":"function","signature":"0x3820eb46"},{"constant":true,"inputs":[],"name":"getOwner","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function","signature":"0x893d20e8"}],"bytecode":"0x6080604052336000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506104bb806100536000396000f30060806040526004361061006d576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806306da7d84146100725780633820eb46146100f8578063893d20e8146101645780638da5cb5b146101bb578063df32754b14610212575b600080fd5b34801561007e57600080fd5b506100a16004803603810190808035600019169060200190929190505050610229565b6040518080602001828103825283818151815260200191508051906020019060200280838360005b838110156100e45780820151818401526020810190506100c9565b505050509050019250505060405180910390f35b34801561010457600080fd5b5061010d6103a3565b6040518080602001828103825283818151815260200191508051906020019060200280838360005b83811015610150578082015181840152602081019050610135565b505050509050019250505060405180910390f35b34801561017057600080fd5b506101796103ff565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b3480156101c757600080fd5b506101d0610428565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34801561021e57600080fd5b5061022761044d565b005b60606000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16141515610315576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260228152602001807f4f6e6c79206f776e65722063616e2063616c6c20746869732066756e6374696f81526020017f6e2e00000000000000000000000000000000000000000000000000000000000081525060400191505060405180910390fd5b6001829080600181540180825580915050906001820390600052602060002001600090919290919091509060001916905550600180548060200260200160405190810160405280929190818152602001828054801561039757602002820191906000526020600020905b8154600019168152602001906001019080831161037f575b50505050509050919050565b606060018054806020026020016040519081016040528092919081815260200182805480156103f557602002820191906000526020600020905b815460001916815260200190600101908083116103dd575b5050505050905090565b60008060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b336000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505600a165627a7a72305820aade2a1bad73348624994925057f7123744e76d2a5995c66a943313c37f764440029","deployedBytecode":"0x60806040526004361061006d576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806306da7d84146100725780633820eb46146100f8578063893d20e8146101645780638da5cb5b146101bb578063df32754b14610212575b600080fd5b34801561007e57600080fd5b506100a16004803603810190808035600019169060200190929190505050610229565b6040518080602001828103825283818151815260200191508051906020019060200280838360005b838110156100e45780820151818401526020810190506100c9565b505050509050019250505060405180910390f35b34801561010457600080fd5b5061010d6103a3565b6040518080602001828103825283818151815260200191508051906020019060200280838360005b83811015610150578082015181840152602081019050610135565b505050509050019250505060405180910390f35b34801561017057600080fd5b506101796103ff565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b3480156101c757600080fd5b506101d0610428565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34801561021e57600080fd5b5061022761044d565b005b60606000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16141515610315576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260228152602001807f4f6e6c79206f776e65722063616e2063616c6c20746869732066756e6374696f81526020017f6e2e00000000000000000000000000000000000000000000000000000000000081525060400191505060405180910390fd5b6001829080600181540180825580915050906001820390600052602060002001600090919290919091509060001916905550600180548060200260200160405190810160405280929190818152602001828054801561039757602002820191906000526020600020905b8154600019168152602001906001019080831161037f575b50505050509050919050565b606060018054806020026020016040519081016040528092919081815260200182805480156103f557602002820191906000526020600020905b815460001916815260200190600101908083116103dd575b5050505050905090565b60008060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b336000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505600a165627a7a72305820aade2a1bad73348624994925057f7123744e76d2a5995c66a943313c37f764440029","sourceMap":"47:359:0:-;;;105:10:2;97:5;;:18;;;;;;;;;;;;;;;;;;47:359:0;;;;;;","deployedSourceMap":"47:359:0:-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;103:131;;8:9:-1;5:2;;;30:1;27;20:12;5:2;103:131:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;23:1:-1;8:100;33:3;30:1;27:10;8:100;;;99:1;94:3;90:11;84:18;80:1;75:3;71:11;64:39;52:2;49:1;45:10;40:15;;8:100;;;12:14;103:131:0;;;;;;;;;;;;;;;;;238:89;;8:9:-1;5:2;;;30:1;27;20:12;5:2;238:89:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;23:1:-1;8:100;33:3;30:1;27:10;8:100;;;99:1;94:3;90:11;84:18;80:1;75:3;71:11;64:39;52:2;49:1;45:10;40:15;;8:100;;;12:14;238:89:0;;;;;;;;;;;;;;;;;331:72;;8:9:-1;5:2;;;30:1;27;20:12;5:2;331:72:0;;;;;;;;;;;;;;;;;;;;;;;;;;;43:20:2;;8:9:-1;5:2;;;30:1;27;20:12;5:2;43:20:2;;;;;;;;;;;;;;;;;;;;;;;;;;;236:47;;8:9:-1;5:2;;;30:1;27;20:12;5:2;236:47:2;;;;;;103:131:0;167:9;175:5:2;;;;;;;;;;;161:19;;:10;:19;;;153:66;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;185:9:0;200:4;185:20;;39:1:-1;33:3;27:10;23:18;57:10;52:3;45:23;79:10;72:17;;0:93;185:20:0;;;;;;;;;;;;;;;;;;;;;;;;;;;220:9;213:16;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;103:131;;;:::o;238:89::-;283:9;313;306:16;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;238:89;:::o;331:72::-;372:7;393:5;;;;;;;;;;;386:12;;331:72;:::o;43:20:2:-;;;;;;;;;;;;;:::o;236:47::-;270:10;262:5;;:18;;;;;;;;;;;;;;;;;;236:47::o","source":"pragma solidity 0.4.25;\nimport \"./Owner.sol\";\n\ncontract AllyCore is Owned {\n  bytes32[]  allyArray;\n\n  function addToAllyArray(bytes32 _dna) public onlyOwner returns (bytes32[]){\n      allyArray.push(_dna);\n      return allyArray;\n  }\n\n  function getAllAllies() public view returns (bytes32[] memory){\n    return allyArray;\n  }\n\n  function getOwner() public view returns (address){\n    return owner;\n  }\n\n}","sourcePath":"/Users/brysonkruk/Documents/projects/ea-sr/contracts/AllyCore.sol","ast":{"absolutePath":"/Users/brysonkruk/Documents/projects/ea-sr/contracts/AllyCore.sol","exportedSymbols":{"AllyCore":[44]},"id":45,"nodeType":"SourceUnit","nodes":[{"id":1,"literals":["solidity","0.4",".25"],"nodeType":"PragmaDirective","src":"0:23:0"},{"absolutePath":"/Users/brysonkruk/Documents/projects/ea-sr/contracts/Owner.sol","file":"./Owner.sol","id":2,"nodeType":"ImportDirective","scope":45,"sourceUnit":137,"src":"24:21:0","symbolAliases":[],"unitAlias":""},{"baseContracts":[{"arguments":null,"baseName":{"contractScope":null,"id":3,"name":"Owned","nodeType":"UserDefinedTypeName","referencedDeclaration":136,"src":"68:5:0","typeDescriptions":{"typeIdentifier":"t_contract$_Owned_$136","typeString":"contract Owned"}},"id":4,"nodeType":"InheritanceSpecifier","src":"68:5:0"}],"contractDependencies":[136],"contractKind":"contract","documentation":null,"fullyImplemented":true,"id":44,"linearizedBaseContracts":[44,136],"name":"AllyCore","nodeType":"ContractDefinition","nodes":[{"constant":false,"id":7,"name":"allyArray","nodeType":"VariableDeclaration","scope":44,"src":"78:20:0","stateVariable":true,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_array$_t_bytes32_$dyn_storage","typeString":"bytes32[]"},"typeName":{"baseType":{"id":5,"name":"bytes32","nodeType":"ElementaryTypeName","src":"78:7:0","typeDescriptions":{"typeIdentifier":"t_bytes32","typeString":"bytes32"}},"id":6,"length":null,"nodeType":"ArrayTypeName","src":"78:9:0","typeDescriptions":{"typeIdentifier":"t_array$_t_bytes32_$dyn_storage_ptr","typeString":"bytes32[]"}},"value":null,"visibility":"internal"},{"body":{"id":25,"nodeType":"Block","src":"177:57:0","statements":[{"expression":{"argumentTypes":null,"arguments":[{"argumentTypes":null,"id":20,"name":"_dna","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":9,"src":"200:4:0","typeDescriptions":{"typeIdentifier":"t_bytes32","typeString":"bytes32"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_bytes32","typeString":"bytes32"}],"expression":{"argumentTypes":null,"id":17,"name":"allyArray","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":7,"src":"185:9:0","typeDescriptions":{"typeIdentifier":"t_array$_t_bytes32_$dyn_storage","typeString":"bytes32[] storage ref"}},"id":19,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberName":"push","nodeType":"MemberAccess","referencedDeclaration":null,"src":"185:14:0","typeDescriptions":{"typeIdentifier":"t_function_arraypush_nonpayable$_t_bytes32_$returns$_t_uint256_$","typeString":"function (bytes32) returns (uint256)"}},"id":21,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"names":[],"nodeType":"FunctionCall","src":"185:20:0","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"id":22,"nodeType":"ExpressionStatement","src":"185:20:0"},{"expression":{"argumentTypes":null,"id":23,"name":"allyArray","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":7,"src":"220:9:0","typeDescriptions":{"typeIdentifier":"t_array$_t_bytes32_$dyn_storage","typeString":"bytes32[] storage ref"}},"functionReturnParameters":16,"id":24,"nodeType":"Return","src":"213:16:0"}]},"documentation":null,"id":26,"implemented":true,"isConstructor":false,"isDeclaredConst":false,"modifiers":[{"arguments":null,"id":12,"modifierName":{"argumentTypes":null,"id":11,"name":"onlyOwner","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":126,"src":"148:9:0","typeDescriptions":{"typeIdentifier":"t_modifier$__$","typeString":"modifier ()"}},"nodeType":"ModifierInvocation","src":"148:9:0"}],"name":"addToAllyArray","nodeType":"FunctionDefinition","parameters":{"id":10,"nodeType":"ParameterList","parameters":[{"constant":false,"id":9,"name":"_dna","nodeType":"VariableDeclaration","scope":26,"src":"127:12:0","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_bytes32","typeString":"bytes32"},"typeName":{"id":8,"name":"bytes32","nodeType":"ElementaryTypeName","src":"127:7:0","typeDescriptions":{"typeIdentifier":"t_bytes32","typeString":"bytes32"}},"value":null,"visibility":"internal"}],"src":"126:14:0"},"payable":false,"returnParameters":{"id":16,"nodeType":"ParameterList","parameters":[{"constant":false,"id":15,"name":"","nodeType":"VariableDeclaration","scope":26,"src":"167:9:0","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_array$_t_bytes32_$dyn_memory_ptr","typeString":"bytes32[]"},"typeName":{"baseType":{"id":13,"name":"bytes32","nodeType":"ElementaryTypeName","src":"167:7:0","typeDescriptions":{"typeIdentifier":"t_bytes32","typeString":"bytes32"}},"id":14,"length":null,"nodeType":"ArrayTypeName","src":"167:9:0","typeDescriptions":{"typeIdentifier":"t_array$_t_bytes32_$dyn_storage_ptr","typeString":"bytes32[]"}},"value":null,"visibility":"internal"}],"src":"166:11:0"},"scope":44,"src":"103:131:0","stateMutability":"nonpayable","superFunction":null,"visibility":"public"},{"body":{"id":34,"nodeType":"Block","src":"300:27:0","statements":[{"expression":{"argumentTypes":null,"id":32,"name":"allyArray","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":7,"src":"313:9:0","typeDescriptions":{"typeIdentifier":"t_array$_t_bytes32_$dyn_storage","typeString":"bytes32[] storage ref"}},"functionReturnParameters":31,"id":33,"nodeType":"Return","src":"306:16:0"}]},"documentation":null,"id":35,"implemented":true,"isConstructor":false,"isDeclaredConst":true,"modifiers":[],"name":"getAllAllies","nodeType":"FunctionDefinition","parameters":{"id":27,"nodeType":"ParameterList","parameters":[],"src":"259:2:0"},"payable":false,"returnParameters":{"id":31,"nodeType":"ParameterList","parameters":[{"constant":false,"id":30,"name":"","nodeType":"VariableDeclaration","scope":35,"src":"283:9:0","stateVariable":false,"storageLocation":"memory","typeDescriptions":{"typeIdentifier":"t_array$_t_bytes32_$dyn_memory_ptr","typeString":"bytes32[]"},"typeName":{"baseType":{"id":28,"name":"bytes32","nodeType":"ElementaryTypeName","src":"283:7:0","typeDescriptions":{"typeIdentifier":"t_bytes32","typeString":"bytes32"}},"id":29,"length":null,"nodeType":"ArrayTypeName","src":"283:9:0","typeDescriptions":{"typeIdentifier":"t_array$_t_bytes32_$dyn_storage_ptr","typeString":"bytes32[]"}},"value":null,"visibility":"internal"}],"src":"282:18:0"},"scope":44,"src":"238:89:0","stateMutability":"view","superFunction":null,"visibility":"public"},{"body":{"id":42,"nodeType":"Block","src":"380:23:0","statements":[{"expression":{"argumentTypes":null,"id":40,"name":"owner","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":105,"src":"393:5:0","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"functionReturnParameters":39,"id":41,"nodeType":"Return","src":"386:12:0"}]},"documentation":null,"id":43,"implemented":true,"isConstructor":false,"isDeclaredConst":true,"modifiers":[],"name":"getOwner","nodeType":"FunctionDefinition","parameters":{"id":36,"nodeType":"ParameterList","parameters":[],"src":"348:2:0"},"payable":false,"returnParameters":{"id":39,"nodeType":"ParameterList","parameters":[{"constant":false,"id":38,"name":"","nodeType":"VariableDeclaration","scope":43,"src":"372:7:0","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"},"typeName":{"id":37,"name":"address","nodeType":"ElementaryTypeName","src":"372:7:0","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"value":null,"visibility":"internal"}],"src":"371:9:0"},"scope":44,"src":"331:72:0","stateMutability":"view","superFunction":null,"visibility":"public"}],"scope":45,"src":"47:359:0"}],"src":"0:406:0"},"legacyAST":{"absolutePath":"/Users/brysonkruk/Documents/projects/ea-sr/contracts/AllyCore.sol","exportedSymbols":{"AllyCore":[44]},"id":45,"nodeType":"SourceUnit","nodes":[{"id":1,"literals":["solidity","0.4",".25"],"nodeType":"PragmaDirective","src":"0:23:0"},{"absolutePath":"/Users/brysonkruk/Documents/projects/ea-sr/contracts/Owner.sol","file":"./Owner.sol","id":2,"nodeType":"ImportDirective","scope":45,"sourceUnit":137,"src":"24:21:0","symbolAliases":[],"unitAlias":""},{"baseContracts":[{"arguments":null,"baseName":{"contractScope":null,"id":3,"name":"Owned","nodeType":"UserDefinedTypeName","referencedDeclaration":136,"src":"68:5:0","typeDescriptions":{"typeIdentifier":"t_contract$_Owned_$136","typeString":"contract Owned"}},"id":4,"nodeType":"InheritanceSpecifier","src":"68:5:0"}],"contractDependencies":[136],"contractKind":"contract","documentation":null,"fullyImplemented":true,"id":44,"linearizedBaseContracts":[44,136],"name":"AllyCore","nodeType":"ContractDefinition","nodes":[{"constant":false,"id":7,"name":"allyArray","nodeType":"VariableDeclaration","scope":44,"src":"78:20:0","stateVariable":true,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_array$_t_bytes32_$dyn_storage","typeString":"bytes32[]"},"typeName":{"baseType":{"id":5,"name":"bytes32","nodeType":"ElementaryTypeName","src":"78:7:0","typeDescriptions":{"typeIdentifier":"t_bytes32","typeString":"bytes32"}},"id":6,"length":null,"nodeType":"ArrayTypeName","src":"78:9:0","typeDescriptions":{"typeIdentifier":"t_array$_t_bytes32_$dyn_storage_ptr","typeString":"bytes32[]"}},"value":null,"visibility":"internal"},{"body":{"id":25,"nodeType":"Block","src":"177:57:0","statements":[{"expression":{"argumentTypes":null,"arguments":[{"argumentTypes":null,"id":20,"name":"_dna","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":9,"src":"200:4:0","typeDescriptions":{"typeIdentifier":"t_bytes32","typeString":"bytes32"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_bytes32","typeString":"bytes32"}],"expression":{"argumentTypes":null,"id":17,"name":"allyArray","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":7,"src":"185:9:0","typeDescriptions":{"typeIdentifier":"t_array$_t_bytes32_$dyn_storage","typeString":"bytes32[] storage ref"}},"id":19,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberName":"push","nodeType":"MemberAccess","referencedDeclaration":null,"src":"185:14:0","typeDescriptions":{"typeIdentifier":"t_function_arraypush_nonpayable$_t_bytes32_$returns$_t_uint256_$","typeString":"function (bytes32) returns (uint256)"}},"id":21,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"names":[],"nodeType":"FunctionCall","src":"185:20:0","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"id":22,"nodeType":"ExpressionStatement","src":"185:20:0"},{"expression":{"argumentTypes":null,"id":23,"name":"allyArray","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":7,"src":"220:9:0","typeDescriptions":{"typeIdentifier":"t_array$_t_bytes32_$dyn_storage","typeString":"bytes32[] storage ref"}},"functionReturnParameters":16,"id":24,"nodeType":"Return","src":"213:16:0"}]},"documentation":null,"id":26,"implemented":true,"isConstructor":false,"isDeclaredConst":false,"modifiers":[{"arguments":null,"id":12,"modifierName":{"argumentTypes":null,"id":11,"name":"onlyOwner","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":126,"src":"148:9:0","typeDescriptions":{"typeIdentifier":"t_modifier$__$","typeString":"modifier ()"}},"nodeType":"ModifierInvocation","src":"148:9:0"}],"name":"addToAllyArray","nodeType":"FunctionDefinition","parameters":{"id":10,"nodeType":"ParameterList","parameters":[{"constant":false,"id":9,"name":"_dna","nodeType":"VariableDeclaration","scope":26,"src":"127:12:0","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_bytes32","typeString":"bytes32"},"typeName":{"id":8,"name":"bytes32","nodeType":"ElementaryTypeName","src":"127:7:0","typeDescriptions":{"typeIdentifier":"t_bytes32","typeString":"bytes32"}},"value":null,"visibility":"internal"}],"src":"126:14:0"},"payable":false,"returnParameters":{"id":16,"nodeType":"ParameterList","parameters":[{"constant":false,"id":15,"name":"","nodeType":"VariableDeclaration","scope":26,"src":"167:9:0","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_array$_t_bytes32_$dyn_memory_ptr","typeString":"bytes32[]"},"typeName":{"baseType":{"id":13,"name":"bytes32","nodeType":"ElementaryTypeName","src":"167:7:0","typeDescriptions":{"typeIdentifier":"t_bytes32","typeString":"bytes32"}},"id":14,"length":null,"nodeType":"ArrayTypeName","src":"167:9:0","typeDescriptions":{"typeIdentifier":"t_array$_t_bytes32_$dyn_storage_ptr","typeString":"bytes32[]"}},"value":null,"visibility":"internal"}],"src":"166:11:0"},"scope":44,"src":"103:131:0","stateMutability":"nonpayable","superFunction":null,"visibility":"public"},{"body":{"id":34,"nodeType":"Block","src":"300:27:0","statements":[{"expression":{"argumentTypes":null,"id":32,"name":"allyArray","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":7,"src":"313:9:0","typeDescriptions":{"typeIdentifier":"t_array$_t_bytes32_$dyn_storage","typeString":"bytes32[] storage ref"}},"functionReturnParameters":31,"id":33,"nodeType":"Return","src":"306:16:0"}]},"documentation":null,"id":35,"implemented":true,"isConstructor":false,"isDeclaredConst":true,"modifiers":[],"name":"getAllAllies","nodeType":"FunctionDefinition","parameters":{"id":27,"nodeType":"ParameterList","parameters":[],"src":"259:2:0"},"payable":false,"returnParameters":{"id":31,"nodeType":"ParameterList","parameters":[{"constant":false,"id":30,"name":"","nodeType":"VariableDeclaration","scope":35,"src":"283:9:0","stateVariable":false,"storageLocation":"memory","typeDescriptions":{"typeIdentifier":"t_array$_t_bytes32_$dyn_memory_ptr","typeString":"bytes32[]"},"typeName":{"baseType":{"id":28,"name":"bytes32","nodeType":"ElementaryTypeName","src":"283:7:0","typeDescriptions":{"typeIdentifier":"t_bytes32","typeString":"bytes32"}},"id":29,"length":null,"nodeType":"ArrayTypeName","src":"283:9:0","typeDescriptions":{"typeIdentifier":"t_array$_t_bytes32_$dyn_storage_ptr","typeString":"bytes32[]"}},"value":null,"visibility":"internal"}],"src":"282:18:0"},"scope":44,"src":"238:89:0","stateMutability":"view","superFunction":null,"visibility":"public"},{"body":{"id":42,"nodeType":"Block","src":"380:23:0","statements":[{"expression":{"argumentTypes":null,"id":40,"name":"owner","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":105,"src":"393:5:0","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"functionReturnParameters":39,"id":41,"nodeType":"Return","src":"386:12:0"}]},"documentation":null,"id":43,"implemented":true,"isConstructor":false,"isDeclaredConst":true,"modifiers":[],"name":"getOwner","nodeType":"FunctionDefinition","parameters":{"id":36,"nodeType":"ParameterList","parameters":[],"src":"348:2:0"},"payable":false,"returnParameters":{"id":39,"nodeType":"ParameterList","parameters":[{"constant":false,"id":38,"name":"","nodeType":"VariableDeclaration","scope":43,"src":"372:7:0","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"},"typeName":{"id":37,"name":"address","nodeType":"ElementaryTypeName","src":"372:7:0","typeDescriptions":{"typeIdentifier":"t_address","typeString":"address"}},"value":null,"visibility":"internal"}],"src":"371:9:0"},"scope":44,"src":"331:72:0","stateMutability":"view","superFunction":null,"visibility":"public"}],"scope":45,"src":"47:359:0"}],"src":"0:406:0"},"compiler":{"name":"solc","version":"0.4.25+commit.59dbf8f1.Emscripten.clang"},"networks":{"4":{"events":{},"links":{},"address":"0x3999fFB4301200dC35442fac8CE37e160B2E3a10","transactionHash":"0xf256a00d327df09a652f8bf548b30ae8e9b6a9293dc8cd80cde15cac830d1cb8"},"5777":{"events":{},"links":{},"address":"0xdaE91B41d6B7DDd2B5A63F5335ad41c11896d109","transactionHash":"0xe025bf891c04b6d5d519e4446104de831bda1f05b78ed69c22d0eef32d9e88f1"}},"schemaVersion":"3.0.2","updatedAt":"2019-04-11T18:08:11.054Z","devdoc":{"methods":{}},"userdoc":{"methods":{}}}

;
const seedRandom = require("seedrandom");
const HDWalletProvider = require('truffle-hdwallet-provider');

require('dotenv').config();
const mnemonic = process.env.MNEMONIC;

var provider = process.env.NODE_ENV === 'development' ? new Web3.providers.HttpProvider("http://127.0.0.1:8545") :  new HDWalletProvider(mnemonic, `https://rinkeby.infura.io/v3/${process.env.INFURAAPIKEY}`);
var web3 = new Web3(provider);
const payingAccount =  process.env.NODE_ENV === 'development' ? '0x895B758229aFF6C0f95146A676bBF579aD7636aa' : process.env.PAYER;

// get contract instance
web3.eth.net.getId().then((id)=>{
  
  const deployedNetwork = contractJson.networks[id];
  const contract = new web3.eth.Contract(
    contractJson.abi,
    deployedNetwork.address,
  );
  // FIRST 3 DIGITS - Generate Series number
  const seriesStr = '001';

  // Generate random string to represent the new ally
  let rng = new seedRandom();
  // NEXT 13 Digits determine ally and attributes
  const num = Math.floor(rng()*10000000000000);
  let strNum = num.toString();
  const cosmetic = '0000';
  const reserveDigits = '0000'
  let combinedStr = seriesStr + strNum + cosmetic + reserveDigits;
  console.log(combinedStr);

  


  console.log('sender', payingAccount);

  contract.methods.owner().call()
  .then((owner) =>{
    console.log('O', owner);
  });

  
  // Call smart contract add method to put the new ally on the blockchain
    contract.methods.addToAllyArray(web3.utils.fromAscii(combinedStr)).send({from: payingAccount, gasPrice : '4700000'})
    .on('transactionHash', (hash) => {
      console.log('HASH - ', hash);
    })
    .on('confirmation', (confirmationNumber, receipt) => {
      console.log('CONFIRM - ', confirmationNumber, receipt);
      process.exit();
    })
    .on('receipt', (receipt) => {
        // receipt example
        console.log('RECEIPT - ',receipt);
        return;
    })
    .on('error', console.error); // If there's an out of gas error the second parameter is the receipt.
    setTimeout(()=>{
      process.exit();
    },200000)
  });
